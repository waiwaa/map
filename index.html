<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>高德地图动态坐标示例</title>
    <script type="text/javascript" src="https://webapi.amap.com/maps?v=1.4.15&key=48a26c4ccf89e691d7625b9c7efec8a8&plugin=AMap.ToolBar"></script>

    <style>
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #container {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="container"></div>

    <script type="text/javascript">
        // 初始化地图
        var map = new AMap.Map('container', {
            zoom: 13,
            center: [116.39,39.9]
        });

        // 从高德API获取最后一个点的坐标
        fetch('https://tsapi.amap.com/v1/track/terminal/lastpoint?key=760530f08e425c5e9fbeb0300e4adba7&sid=408758&tid=400396751&correction=n')
            .then(response => response.json())
            .then(data => {
                if (data.errmsg === "OK") {
                    // 获取坐标
                    const lng = data.data.location.split(',')[0];
                    const lat = data.data.location.split(',')[1];
		    //console.log(data.data.locatetime);
			 console.log(lng);
			 console.log(lat);

                    // 创建并设置标记
                    const marker = new AMap.Marker({
                        position: [parseFloat(lng), parseFloat(lat)],
                        title: '终端位置'
                    });

                    // 将标记添加到地图中
                    marker.setMap(map);

                    // 调整地图中心和缩放级别以适应标记
                    map.setCenter([parseFloat(lng), parseFloat(lat)]);
                    map.setZoom(16);
                } else {
                    console.error('无法获取坐标信息:', data.info);
                }
            })
            .catch(error => {
                console.error('请求失败:', error);
            });
    </script>
</body>
</html>
